"0","feature_subset <- c(""class"", ""Housing_Median_Age"", ""Bedrooms"", ""Population"", ""id"")"
"0","train <- binned_data %>% sample_frac(.5) %>% select(features)"
"0","test  <- anti_join(binned_data, train, by = 'id')"
"0",""
"0","# Create model with default paramters"
"0","control <- trainControl(method=""repeatedcv"", number=2, repeats=1, search=""grid"")"
"0","# control <- trainControl(method = ""none"")"
"0","set.seed(42)"
"0","tune.grid.neuralnet <- data.frame("
"0","  layer1 = c(2, 4, 6, 8, 10, 12, 14, 16, 18, 20),"
"0","  layer2 = 0,"
"0","  layer3 = 0"
"0",")"
"0","nn_gridsearch <- train(as.numeric(class) ~ ., "
"0","                       data = train %>% select(-id),"
"0","                       method = ""neuralnet"","
"0","                       threshold = 0.1,"
"0","                       rep = 1,"
"0","                       preProc = c(""center"", ""scale""),"
"0","                       tuneGrid = tune.grid.neuralnet, "
"0","                       trControl = control)"
